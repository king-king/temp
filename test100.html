<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <title>海报</title>
    <style>
        html, body {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            margin: 0;
        }

        canvas {
            /*background: black;*/
            position: absolute;
            left: 200px;
            top: 100px;
            width: 86px;
            height: 86px;
        }
    </style>
</head>
<body>
<canvas width="86" height="86"></canvas>
<script>
    //    var data = [
    //        {
    //            name : ".page2-tag0" ,
    //            x : 730 ,
    //            h : 72 ,
    //            y : 1060
    //        } ,
    //        {
    //            name : ".page2-tag1" ,
    //            x : 730 ,
    //            h : 72 ,
    //            y : 1174
    //        }
    //    ];
    //
    //    var result = "";
    //    for ( var i = 0; i < data.length; i++ ) {
    //        result += data[ i ].name + "{top:" + (data[ i ].y - 768) / 768 + "%;left:" + (data[ i ].x - 128) / 768 + "%;height:" + data[ i ].h / 768 + "%;}"
    //    }
    //    console.log( result )

    var canvas = document.querySelector( "canvas" );
    var gc = canvas.getContext( "2d" );
    var img = new Image();
    var img2 = new Image();
    var count = 0;
    img2.src = "chuye-site/img/clock-pointer.png";// 4*52
    img.src = "chuye-site/img/clock.png";// 86*86
    img.onload = function () {
        ++count == 2 && draw();
    };
    img2.onload = function () {
        ++count == 2 && draw();
    };
    var da = Math.PI / 180;
    var da0 = -Math.PI / 2;
    function draw() {
        function frame( angle ) {
            gc.clearRect( 0 , 0 , 86 , 86 );
            gc.fillStyle = angle == 360 ? "white" : "#ffecc4";
            gc.save();
            gc.beginPath();
            gc.moveTo( 43 , 43 );
            gc.lineTo( 43 , 13 );
            gc.arc( 43 , 43 , 29 , da0 , da0 + da * angle );
            gc.lineTo( 43 , 43 );
            gc.closePath();
            gc.fill();
            gc.drawImage( img , 0 , 0 );
            gc.translate( 43 , 43 );
            gc.rotate( da * angle );
            gc.drawImage( img2 , -2 , -26 );
            gc.restore();
        }

        var angle = 0;
        setTimeout( function () {
            angle += 2;
            if ( angle <= 360 ) {
                frame( angle );
                setTimeout( arguments.callee , 20 );
            }
        } , 20 );
    }

</script>
</body>
</html>