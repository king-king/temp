<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <title>✨</title>
    <style>
        html, body, .body {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: 0;
        }

        .bg {
            position: absolute;
            height: 100%;
        }

        .star {
            position: absolute;
            top: 0;
        }

        @keyframes down0 {
            0% {
                transform: translate3d(0, -100%, 0);
            }
            100% {
                transform: translate3d(50px, 580px, 0) rotate3d(0, 0, 1, 160deg);
            }
        }

        @keyframes down1 {
            0% {
                transform: translate3d(0, -100%, 0);
            }
            100% {
                transform: translate3d(40px, 580px, 0) rotate3d(0, 0, 1, -160deg);
            }
        }

        @keyframes down2 {
            0% {
                transform: translate3d(0, -100%, 0);
            }
            100% {
                transform: translate3d(-42px, 580px, 0) rotate3d(0, 0, 1, 160deg);
            }
        }

        @keyframes down3 {
            0% {
                transform: translate3d(0, -100%, 0);
            }
            100% {
                transform: translate3d(-12px, 580px, 0) rotate3d(0, 0, 1, -170deg);
            }
        }
    </style>
</head>
<body>
<div class="body">
    <img src="1.jpg" class="bg">
</div>
<script>
    (function () {
        var body = document.querySelector(".body");
        var stars = [];

//        setTimeout(function () {
//            for (var i = 0; i < 4; i++) {
//                var img = new Image();
//                img.src = "star" + i % 3 + ".png";
//                img.classList.add("star");
//                img.style.left = Math.random() * (body.offsetWidth - width) + "px";
//                img.style.animation = "down" + i + " " + (3.5 + Math.random()) + "s linear " + i / 2 + "s both infinite"
//            }
//            num += 4;
//            if (num < 30) {
//                setTimeout(arguments.callee, 1000);
//            }
//        }, 1000);

        var starIndex = 0;
        var vxs = [0.15, -0.15, 0.12, -0.13];
        var drs = [0.4, -0.4, -0.3, 0.5];

        function init(img) {
            var width = Math.random() * 15 + 10;
            img.wqy = -width * 1.8;
            img.style.top = "0px";
            img.style.width = width + "px";
            img.wqw = width;
            img.wqr = 0;
            img.wqx = Math.random() * (body.offsetWidth - width);
            img.style.transform = "translate3d(" + img.wqx + "px," + img.wqy + "px,0)";
            img.wqvx = vxs[starIndex % 4];
        }

        var id1, id2;
        // 每隔0.5s生成一个星星
        id1 = setTimeout(function () {
            clearTimeout(id1);
            var img = new Image();
            img.wqdr = drs[starIndex % 4];
            img.src = "star" + starIndex % 3 + ".png";
            body.appendChild(img);
            img.classList.add("star");
            stars.push(img);
            init(img);
            starIndex++;
            if (starIndex < 20) {
                id1 = setTimeout(arguments.callee, 500);
            }
        }, 200);

        // 绘制
        id2 = setTimeout(function () {
            clearTimeout(id2);
            for (var i = 0; i < stars.length; i++) {
                stars[i].wqy += 1.8;
                stars[i].wqx += stars[i].wqvx;
                stars[i].wqr += stars[i].wqdr;
                stars[i].style.transform = "translate3d(" + stars[i].wqx + "px," + stars[i].wqy + "px,0) rotate3d(0,0,1," + (stars[i].wqr) + "deg)";
                if (stars[i].wqy > body.offsetHeight + stars[i].wqw * 2) {
                    init(stars[i]);
                }
            }
            id2 = setTimeout(arguments.callee, 16);
        }, 20);

    })();
</script>
</body>
</html>