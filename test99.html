<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <meta name="mobileoptimized" content="0"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="portrait">
    <meta name="browsermode" content="application">
    <title></title>
    <style>
        .border {
            width: 200px;
            margin: 2px;
            height: 10px;
            background: red;
        }
    </style>
<body>
<script>
    (function () {

        function test() {
            var el = [];


            var i = 0;
            var id = setTimeout( function () {
                if ( i < 500 ) {
                    clearTimeout( id );
                    var e = document.createElement( "div" );
                    e.classList.add( "border" );
                    document.body.appendChild( e );
                    e.onclick = function () {

                    };
                    el.push( e );
                    id = setTimeout( arguments.callee, 10 );
                    i++;
                }
                else {
                    console.log( "ok" );
                    for ( var j = 0; j < el.length; j++ ) {
                        document.body.removeChild( el[j] );
                        el[j].onclick = null;
                        el[j] = null;
                    }
                    el = null;
                    console.log( "over" );
                }
            }, 10 );

//            for ( var j = 0; j < el.length; j++ ) {
////                el[j].parentNode.removeChild( el[j] );
//            }
        }


        test();

    })();
</script>
</body>
</html>