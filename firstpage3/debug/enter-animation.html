<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="mobileoptimized" content="0"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="portrait">
    <meta name="browsermode" content="application">

    <title>调试入场动画</title>

    <style>
        body {
            font-family: "微软雅黑", sans-serif;
        }
    </style>

    <script src="../lib/zach/client.js"></script>
    <script>
        main( function () {
            var debug = imports( "./debug.js" );
            var object = imports( "object" );
            var parent = window.parent;
            var enterAnimationList = {};
            var sidebar;

            function setup( enterAnimation ) {
                layoutFormats.test = {
                    create : function ( layout, ds ) {
                        layout.background = "white";

                        var img = Component( Content.Image( ds.image( 0 ), 200, 150 ), layout );
                        img.y = 50;
                        img.x = p.center( img );

                        var img2 = Component( Content.Image( ds.image( 0 ), 120, 90 ), layout );
                        img2.y = 250;
                        img2.x = p.center( img2 );
                        img2.scale = 1.2;
                        img2.rotate = 30;

                        var text = Component( Content.Image( ds.image( 1 ) ), layout );
                        text.y = 400;
                        text.x = p.center( text );

                        sequence( [[img, enterAnimation], [img2, enterAnimation], [text, enterAnimation]] );
                    }
                };
            }

            fp.loadWork = function ( callback ) {
                callback( {
                    pageSwitch : "classic",
                    pages : [{
                        label : "test",
                        image : [imgLib.Koala, debugImage( "mi06/2.png" )]
                    }]
                } );
            };


            debug.loadFirstPage( {
                type : "local"
            }, function () {
                debug.loadData( {
                    dir : "enter-animation-list",
                    doOut : function ( pageData ) {
                        object.foreach( pageData, function ( name, data ) {
                            enterAnimationList[name] = data;
                        } );
                    }
                }, function () {
                    if ( parent == window ) {
                        sidebar = debug.Options( {
                            name : "enter-animation",
                            fontSize : 11,
                            width : 60
                        } );

                        object.foreach( enterAnimationList, function ( name, data ) {
                            sidebar.option( name, data );
                        } );

                        debug.setup = function () {
                            setup( sidebar.data );
                        };

                        debug.start();
                    }
                    else {
                        parent.onPhoneLoad && parent.onPhoneLoad( {
                            enterAnimationList : enterAnimationList,
                            run : function ( enterAnimation ) {
                                setup( enterAnimation );
                                runFirstPage();
                            }
                        } );
                    }
                } );
            } );
        } );
    </script>
</head>
<body>
</body>
</html>