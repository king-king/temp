<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <meta name="mobileoptimized" content="0"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="portrait">
    <meta name="browsermode" content="application">
    <title></title>
    <style>
        * {
            margin: 0;
        }

        html, body, .page {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0);
            overflow: hidden;
        }

        @-webkit-keyframes animate0 {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                -webkit-transform: translate3d(-300%, 200%, 0) scale(1.2) rotateZ(-30deg);
                opacity: 0;
            }
        }

        @-webkit-keyframes animate1 {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                -webkit-transform: translate3d(-300%, -200%, 0) scale(1.1) rotateZ(30deg);
                opacity: 0;
            }
        }

        @-webkit-keyframes animate2 {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                -webkit-transform: translate3d(-300%, 170%, 0) scale(1.1) rotateZ(30deg);
                opacity: 0;
            }
        }

        @-webkit-keyframes animate3 {
            0% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                -webkit-transform: translate3d(-300%, 0, 0) scale(1.1) rotateZ(30deg);
                opacity: 0;
            }
        }

        img.heart {
            width: 10px;
            height: 10px;
            position: absolute;
            opacity: 0;
        }
    </style>
</head>
<body>
<div class="page"></div>
<script>

    function requestFrames( arg ) {
        var handle;

        var s = (new Date()).getTime();

        var duration = arg.duration * 1000;

        function animate() {
            if ( (new Date()).getTime() - s > duration ) {
                return;
            }

            clearTimeout( handle );
            arg.onAnimate && arg.onAnimate( ((new Date()).getTime() - s) / duration );
            handle = setTimeout( arguments.callee, 1000 / 30 );
        }

        animate();
        return {
            remove : function () {
                clearTimeout( handle );
            }
        }

    }

    document.body.onload = function () {
        var clientHeight = document.body.offsetHeight;
        var clientWidth = document.body.offsetWidth;
        var page = document.querySelector( ".page" );
        var id = location.search.slice( 4 );
        page.innerHTML = "";
        if ( id ) {
            switch ( id ) {
                case "heart":
                    var i = 0;
                    requestFrames( {
                        duration : 3,
                        onAnimate : function ( process ) {
                            var img = new Image();
                            img.classList.add( "heart" );
                            page.appendChild( img );
                            i += 1;
                            img.src = "heart.png";
                            img.style.left = ((20 + (clientWidth - 10) * process) << 0) + "px";
                            img.style.top = 300 / 480 * clientHeight + "px";
                            img.style.webkitAnimation = "animate" + i % 4 + " " + (Math.random() * 2 + 0.2) + "s ease-out " + (Math.random() / 10) + "s forwards";
                            img.style.animation = "animate" + i % 4 + " " + (Math.random() * 2 + 0.2) + "s ease-out " + (Math.random() / 10) + "s forwards";
                        }
                    } );
                    break;
                default :
                    alert( "参数不对" );
            }
        }
    };


</script>
</body>
</html>